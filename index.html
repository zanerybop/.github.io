<!DOCTYPE html>
<html manifest="manifest.mf">
  <head>
    <title>Offline Support</title>
    <script type="text/javascript">
      const initialize = () => {
        let status = "Offline";
        if (navigator.onLine) {
          status = "Online";
          retrieveCountries();
        }

        document.getElementById("status").innerHTML = status;
      };

      const retrieveCountries = () => {
        const xhr = new XMLHttpRequest();
        const url = "https://restcountries.eu/rest/v2/all";
        xhr.onreadystatechange = () => {
          if (xhr.readyState === 4) {
            displayCountries(JSON.parse(xhr.response));
          }
        };

        xhr.open("get", url);
        xhr.send();
      };

      const displayCountries = countries => {
        const ul = document.getElementById("countries");

        countries.forEach(country => {
          const li = document.createElement("li");
          li.appendChild(document.createTextNode(country.name));
          ul.appendChild(li);
        });
      };
    </script>
  </head>
  <body onload="initialize()">
    <div id="status"></div>
    <ul id="countries"></ul>
  </body>
</html>
